<div style="height: 655px;">
  <div class="container mt-3 mb-3">
    <div class="row">
      <div class="col"></div>
      <div class="col">
        <h1>レビュー新規作成</h1>
        <% if @review.errors.any? %>
          <%= @review.errors.count %>件の記入ミスがあります
          <ul>
            <% @review.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        <% end %>
        <% if flash[:notice] == "季節が入力されていません。" %>
        <ul>
          <li><%= flash[:notice] %></li>
        </ul>
        <% end %>
      </div>
      <div class="col"></div>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <div class="col-2"></div>
      <div class="col">
        <%= form_with model: @review, url: campsite_reviews_path(params[:campsite_id]) do |f| %>
            <table class="table">
              <tr>
                <th class="border-0 text-center col-2"><%= f.label :review_image, 'レビュー画像' %></th>
                <td class="border-0"><%= f.file_field :review_image, accept: "image/*" %></td>
              </tr>
              <tr>
                <th class="border-0 text-center"><%= f.label :title, 'レビュータイトル' %></th>
                <td class="border-0">
                  <%= f.text_field :title, class:"form-control form-control-sm align-middle", style:"width: 400px;" %>
                  <span id="title-count" class="text-right text-top">0 / 30文字</span>
                </td>
              </tr>
              <tr>
                <th class="border-0 text-center"><%= f.label :tag_name, "季節" %></th>
                <td class="border-0">
                  <%= f.text_field :tag_name, class:"form-control form-control-sm align-middle", style:"width: 100px;" %>
                  <span>(春・夏・秋・冬のいずれかを入力してください。)</span>
                </td>
              </tr>
              <tr>
                <th class="border-0 text-center"><%= f.label :star, '評価', class:'md-3 col-form-label' %></th>
                  <td id="star" class="border-0 align-middle"><%= f.hidden_field :star, id: :review_star %></td>
                <script>
                $('#star').empty();
                  raty(document.getElementById('star'), {
                   starOn: '<%= asset_path('star-on.png') %>',
                   starOff: '<%= asset_path('star-off.png') %>',
                   scoreName: 'review[star]',
                   half: false
                  });
                </script>
              </tr>
              <tr>
                <th class="border-0 text-center"><%= f.label :comment, 'コメント' %></th>
                <td class="border-0">
                  <%= f.text_area :comment, class:"form-control form-control-sm align-middle", style:"width: 400px; height: 150px;" %>
                  <span id="comment-count" class="text-right text-muted">0 / 200文字</span>
                </td>
              </tr>
              <tr>
                <th class="border-0"></th>
                <td class="border-0"><%= f.submit 'レビュー投稿', class: 'btn btn-success' %></td>
              </tr>
            </table>
          <% end %>
      </div>
    </div>
  </div>
</div>

<%#文字数カウンター%>
<script>
  $(document).ready(function() {
    const textField = $("#review_title");
    const textArea = $("#review_comment");
    const titleCount = $("#title-count")
    const commentCount = $("#comment-count");

    textField.on("input", function() {
      const count = textField.val().length;
      titleCount.text(count + " / 30文字");
    });

    textArea.on("input", function() {
      const count = textArea.val().length;
      commentCount.text(count + " / 200文字");
    });
  });
</script>